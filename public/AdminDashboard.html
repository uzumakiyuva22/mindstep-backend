<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MindStep Admin Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>

:root{
  --cyan:#00eaff;
  --blue:#4d7cff;
  --pink:#ff3ea5;
  --glass:rgba(255,255,255,0.08);
  --border:rgba(255,255,255,0.15);
}

/* RESET */
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter, sans-serif;}
html{scroll-behavior:smooth}

body{
  background:
  radial-gradient(circle at 20% 20%, rgba(0,150,255,0.22), transparent 60%),
  radial-gradient(circle at 80% 70%, rgba(255,0,140,0.22), transparent 60%),
  linear-gradient(135deg, #04040d, #090922 50%, #050515 100%);
  height:100vh;
  overflow-x:hidden;
  animation:bgMove 16s ease infinite;
  color:white;
}

@keyframes bgMove {
  0%{background-position:0% 0%;}
  50%{background-position:100% 80%;}
  100%{background-position:0% 0%;}
}

/* floating glow particles */
body::before{
  content:"";
  position:fixed; inset:0;
  pointer-events:none;
  background-image:
    radial-gradient(2px 2px at 30% 40%, rgba(0,229,255,0.6), transparent),
    radial-gradient(2px 2px at 75% 65%, rgba(255,62,160,0.6), transparent),
    radial-gradient(1px 1px at 50% 85%, rgba(255,255,255,0.5), transparent);
  animation:float 25s infinite ease-in-out;
  opacity:.4;
}

@keyframes float{
  0%{transform:translateY(0);}
  50%{transform:translateY(-50px);}
  100%{transform:translateY(0);}
}

/* NAVBAR */
nav{
  width:100%;
  padding:16px 28px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:rgba(255,255,255,0.03);
  border-bottom:1px solid var(--border);
  backdrop-filter:blur(12px);
  position:sticky;
  top:0;
  z-index:1000;
}

.logo{
  font-family:Orbitron;
  font-size:24px;
  font-weight:700;
  text-shadow:0 0 15px var(--cyan);
}

.nav-btn{
  padding:10px 18px;
  background:linear-gradient(90deg,var(--pink),var(--blue));
  border-radius:12px;
  color:white;
  border:none;
  cursor:pointer;
  font-weight:700;
  transition:.3s;
}
.nav-btn:hover{transform:scale(1.05);}

/* DASHBOARD LAYOUT */
.dashboard{
  display:grid;
  grid-template-columns:240px auto;
  height:calc(100vh - 70px);
}

/* SIDEBAR */
.sidebar{
  background:rgba(255,255,255,0.04);
  backdrop-filter:blur(18px);
  border-right:1px solid rgba(255,255,255,0.15);
  padding:20px;
}

.sidebar h3{
  font-family:Orbitron;
  margin-bottom:20px;
}

.side-link{
  padding:12px;
  margin-bottom:10px;
  border-radius:12px;
  cursor:pointer;
  color:#d8eaff;
  transition:.3s;
}
.side-link:hover{
  background:rgba(255,255,255,0.1);
  color:var(--cyan);
  box-shadow:0 0 12px var(--cyan);
}

/* MAIN CONTENT */
.content{
  padding:30px;
  overflow-y:auto;
}

/* PAGE TITLE */
.page-title{
  font-family:Orbitron;
  font-size:28px;
  text-shadow:0 0 12px var(--cyan);
}

/* WIDGETS */
.widgets{
  margin-top:30px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:22px;
}

.widget{
  background:rgba(255,255,255,0.06);
  padding:22px;
  border-radius:18px;
  backdrop-filter:blur(14px);
  border:1px solid rgba(255,255,255,0.15);
  text-align:center;
  box-shadow:0 0 20px rgba(0,0,0,0.35);
  transform:translateY(25px);
  opacity:0;
  transition:.6s;
}

.widget.show{
  opacity:1;
  transform:translateY(0);
}

.widget h4{
  font-size:16px;
  opacity:.85;
}
.widget .value{
  margin-top:8px;
  font-size:32px;
  font-weight:700;
  text-shadow:0 0 10px var(--cyan);
}

/* USER TABLE */
.table-box{
  margin-top:40px;
  background:rgba(255,255,255,0.08);
  padding:25px;
  border-radius:18px;
  backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,0.15);
  box-shadow:0 0 20px rgba(0,0,0,0.35);
}

.table-box h3{
  font-family:Orbitron;
  font-size:22px;
  margin-bottom:15px;
}

table{
  width:100%;
  border-collapse:collapse;
}

table th, table td{
  padding:12px;
  border-bottom:1px solid rgba(255,255,255,0.12);
  text-align:left;
}

table th{
  background:rgba(255,255,255,0.1);
  font-weight:700;
}

table tr:hover{
  background:rgba(255,255,255,0.06);
}

/* LOGOUT POPUP */
.alert-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.8);
  backdrop-filter:blur(8px);
  display:none;
  justify-content:center;
  align-items:center;
}

.alert-box{
  background:rgba(255,255,255,0.08);
  padding:30px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.2);
  text-align:center;
  width:300px;
  color:white;
  animation:pop .5s;
}

.alert-buttons{
  margin-top:20px;
  display:flex;
  justify-content:space-around;
}

.alert-buttons button{
  padding:10px 20px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-weight:700;
  transition:.3s;
}

.alert-buttons .ok{
  background:linear-gradient(90deg,var(--pink),var(--blue));
  color:white;
}

.alert-buttons .cancel{
  background:rgba(255,255,255,0.1);
  color:white;
}

.alert-buttons button:hover{
  transform:scale(1.08);
}

/* RESPONSIVE */
@media(max-width:820px){
  .dashboard{grid-template-columns:1fr;}
  .sidebar{display:none;}
}

</style>
</head>

<body>

<nav>
  <div class="logo">Admin Panel</div>
  <button class="nav-btn" id="logoutBtn">Logout</button>
</nav>

<div class="dashboard">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <h3>Dashboard</h3>
    <div class="side-link">Overview</div>
    <div class="side-link">Users</div>
    <div class="side-link">Courses</div>
    <div class="side-link">Reports</div>
    <div class="side-link">Settings</div>
  </div>

  <!-- CONTENT -->
  <div class="content">

    <div class="page-title">Welcome, Admin</div>

    <!-- WIDGETS -->
    <div class="widgets">
      <div class="widget"><h4>Total Users</h4><div class="value" id="uCount">0</div></div>
      <div class="widget"><h4>Active Courses</h4><div class="value">5</div></div>
      <div class="widget"><h4>Daily Visits</h4><div class="value">224</div></div>
      <div class="widget"><h4>Reports</h4><div class="value">3</div></div>
    </div>

    <!-- TABLE -->
    <div class="table-box">
      <h3>Registered Users</h3>
      <table id="adminTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Joined</th>
          </tr>
        </thead>
        <tbody id="userRows">
        </tbody>
      </table>
    </div>

  </div>
</div>


<!-- LOGOUT MODAL -->
<div class="alert-overlay" id="alertOverlay">
  <div class="alert-box">
    <h3>Logout?</h3>
    <p>Do you want to exit the admin panel?</p>
    <div class="alert-buttons">
      <button class="ok" id="yesLogout">Logout</button>
      <button class="cancel" id="noLogout">Cancel</button>
    </div>
  </div>
</div>
<script>

/* Show widgets animation */
document.querySelectorAll(".widget").forEach((w,i)=>{
  setTimeout(()=>w.classList.add("show"), 200*i);
});

/* LOGOUT */
document.getElementById("logoutBtn").onclick = ()=>{
  document.getElementById("alertOverlay").style.display="flex";
};

document.getElementById("noLogout").onclick = ()=>{
  document.getElementById("alertOverlay").style.display="none";
};

document.getElementById("yesLogout").onclick = ()=>{
  location.href="AdminLogin.html";
};

/* LOAD USERS */
async function loadUsers(){
  try{
    const res = await fetch("/api/admin/users");
    const data = await res.json();

    if(data.success){

      // USER COUNT
      document.getElementById("uCount").textContent = data.users.length;

      // FIXED FIELD NAMES
      const rows = data.users.map(
        u => `
        <tr>
          <td>${u.id}</td>
          <td>${u.username}</td>
          <td>${u.email}</td>
          <td>${u.created_at}</td>
        </tr>`
      ).join("");

      document.getElementById("userRows").innerHTML = rows;
    }

  } catch(e){
    console.log("Error loading users:", e);
  }
}

if(localStorage.getItem("adminLogged") !== "true"){
  location.href = "AdminLogin.html";
}

loadUsers();

</script>
</body>
</html>
