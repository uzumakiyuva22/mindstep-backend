<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Login / Signup Page</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }

body {
  display: flex; justify-content: center; align-items: center;
  height: 100vh;
  background: linear-gradient(135deg, #e74c3c, #3498db);
}

.container {
  position: relative;
  width: 800px; height: 550px;
  border-radius: 12px;
  display: flex; overflow: hidden;
  box-shadow: 0 0 20px rgba(0,0,0,0.6);
}

/* Login & Signup boxes */
.form-box {
  position: absolute;
  width: 50%; height: 100%;
  background: rgba(0,0,0,0.9);
  padding: 40px;
  display: flex; flex-direction: column; justify-content: center;
  color: white;
  transition: .6s ease-in-out;
}

.login-box { left: 0; z-index: 2; }
.signup-box { left: 0; opacity: 0; transform: translateX(-100%); z-index: 1; }

.container.active .login-box {
  transform: translateX(100%);
  opacity: 0; z-index: 1;
}

.container.active .signup-box {
  transform: translateX(0);
  opacity: 1; z-index: 2;
}

.welcome-box {
  position: absolute;
  right: 0;
  width: 50%; height: 100%;
  background: linear-gradient(135deg,#3498db,#e74c3c);
  display: flex; flex-direction: column;
  justify-content: center; align-items: center;
  text-align: center; padding: 40px; color: white;
}

/* Form fields */
.input-box {
  position: relative; margin-bottom: 18px;
}

.input-box input {
  width: 100%;
  padding: 12px;
  padding-left: 12px;
  border: none;
  border-bottom: 2px solid #666;
  background: transparent;
  color: white;
  font-size: 16px;
}
.input-box input:focus { border-bottom-color: #3498db; }

.btn {
  width: 100%; padding: 12px;
  border-radius: 25px;
  background: linear-gradient(to right, #e74c3c,#3498db);
  border: none; color: white; font-size: 18px;
  cursor: pointer;
}

/* Admin Login Button FIXED */
.admin-btn {
  margin-top: 15px;
  background: #222;
  width: 100%;
  padding: 10px;
  border-radius: 12px;
  color: white;
  cursor: pointer;
  text-align: center;
}

.toggle-text { margin-top: 10px; text-align: center; }
.toggle-text a { cursor:pointer; font-weight:bold; color:#eee; }

/* Signup image preview */
#profileLabel {
  width: 100px; height: 100px;
  border-radius: 50%; border: 2px dashed #3498db;
  display:flex; justify-content:center; align-items:center;
  margin: 0 auto 15px; cursor:pointer; color:#3498db;
}

#signup-preview {
  width: 100px; height: 100px;
  border-radius: 50%;
  object-fit: cover;
  border:3px solid #3498db;
  margin:0 auto 15px; display:none;
}

.toast {
  position:fixed; bottom:30px; left:50%;
  transform:translateX(-50%);
  background:#333; padding:12px 25px; color:white;
  border-radius:25px;
  opacity:0; transition:.4s;
}
.toast.show { opacity:1; bottom:50px; }
</style>
</head>

<body>
<div class="container" id="container">

  <!-- LOGIN BOX -->
  <div class="form-box login-box">
    <h2>Login</h2>

    <div class="input-box">
      <input id="login-username" type="text" placeholder="Username">
    </div>

    <div class="input-box">
      <input id="login-password" type="password" placeholder="Password">
    </div>

    <button class="btn" id="loginBtn">Login</button>

    <div class="admin-btn" onclick="window.location.href='AdminLogin.html'">üë®‚Äçüíº Administrator Login</div>

    <div class="toggle-text">Don't have an account? <a id="showSignup">Sign Up</a></div>
  </div>

  <!-- SIGNUP BOX -->
  <div class="form-box signup-box">
    <h2>Sign Up</h2>

    <label id="profileLabel">+</label>
    <input id="signup-image" type="file" accept="image/*" style="display:none;">
    <img id="signup-preview">

    <div class="input-box">
      <input id="signup-username" type="text" placeholder="Username">
    </div>

    <div class="input-box">
      <input id="signup-email" type="email" placeholder="Email">
    </div>

    <div class="input-box">
      <input id="signup-password" type="password" placeholder="Password">
    </div>

    <div class="input-box">
      <input id="signup-confirm" type="password" placeholder="Confirm Password">
    </div>

    <button class="btn" id="signupBtn">Sign Up</button>

    <div class="toggle-text">Already have an account? <a id="showLogin">Login</a></div>
  </div>

  <!-- WELCOME BOX -->
  <div class="welcome-box">
    <h1>WELCOME BACK!</h1>
    <p>Your learning journey continues here üöÄ</p>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// ---------------- Form switching ----------------
const container = document.getElementById("container");
document.getElementById("showSignup").onclick = () => container.classList.add("active");
document.getElementById("showLogin").onclick = () => container.classList.remove("active");

// ---------------- Image Preview ----------------
document.getElementById("profileLabel").onclick = () =>
  document.getElementById("signup-image").click();

document.getElementById("signup-image").onchange = e => {
  const file = e.target.files[0];
  if (!file) return;
  document.getElementById("signup-preview").src = URL.createObjectURL(file);
  document.getElementById("signup-preview").style.display = "block";
  document.getElementById("profileLabel").style.display = "none";
};

// ---------------- Toast ----------------
function toast(msg) {
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 2500);
}

// ---------------- SIGNUP ----------------
document.getElementById("signupBtn").onclick = async () => {
  const username = signup-username.value.trim();
  const email = signup-email.value.trim();
  const password = signup-password.value.trim();
  const confirm = signup-confirm.value.trim();
  const img = document.getElementById("signup-image").files[0];

  if (!username || !email || !password || !confirm)
    return toast("Fill all fields");
  if (password !== confirm)
    return toast("Passwords do not match");

  const fd = new FormData();
  fd.append("username", username);
  fd.append("email", email);
  fd.append("password", password);
  if (img) fd.append("image", img);

  const res = await fetch("/signup", { method: "POST", body: fd });
  const data = await res.json();

  if (res.ok) {
    toast("Signup success!");
    setTimeout(() => location.href="/main", 1500);
  } else toast(data.message || "Signup failed");
};

// ---------------- LOGIN ----------------
document.getElementById("loginBtn").onclick = async () => {
  const username = login-username.value.trim();
  const password = login-password.value.trim();
  if (!username || !password) return toast("Enter username & password");

  const res = await fetch("/login", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({ username, password })
  });

  const data = await res.json();

  if (res.ok) {
    localStorage.setItem("username", data.user.username);
    localStorage.setItem("userImage", data.user.image);
    toast("Login success!");
    setTimeout(()=> location.href="/MainPage.html", 1200);
  } else toast(data.message);
};
</script>

</body>
</html>
